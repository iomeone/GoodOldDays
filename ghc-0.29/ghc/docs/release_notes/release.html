<html>
<!-- Generated by lit2html -->
<head>
<title>Release notes for Glasgow Haskell</title>
</head>
<body>
<h1>Release notes for Glasgow Haskell</h1>
<address>Will Partain (for the AQUA Team)  Department of Computing Science  University of Glasgow  Glasgow, Scotland  G12 8QQ    Email: glasgow-haskell-{users,bugs}-request@dcs.glasgow.ac.uk<br>
</address>
<hr><p>
<p>

<a name="release-0-26"><h2>Release notes for version 0.26 -- 7/95</h2></a>
Release 0.26 is a major public release of Glasgow Haskell.
It incorporates our new work for the first half of 1995.
<p>
The announcement for this release is distributed as <tt>ANNOUNCE-0.26</tt>
in the top-level directory.
<p>
You'll need to recompile everything if you're switching from a
previous version of GHC.  (If you don't, you'll get "consistency
errors".)  Some day, we will stop doing this to you :-)
<p>
Information about "what's ported to which machine" is now given in
the Installation Guide.
The new ports since 0.23 are: <tt>hppa1.1-hp-hpux</tt>,
<tt>i386-*-linuxaout</tt>, and <tt>mips-sgi-irix5</tt>.
<p>

<a name="0-26-config"><h3>New configuration things in 0.26</h3></a>

<p>
We are moving towards one <tt>configure</tt> script for all Glasgow
functional-programming tools.  Consequently, the configure options
have been tweaked.  Doing <tt>./configure --help</tt> will show you the
current state of play.
<p>

<a name="0-26-user-visible"><h3>User-visible changes in 0.26, including incompatibilities</h3></a>

<p>
The names <tt>scc</tt>, <tt>ccall</tt>, and <tt>casm</tt> are no longer stolen
from the user's name space.  (The magical constructs they once were
have been known as <tt>_scc_</tt>, <tt>_ccall_</tt>, and <tt>_casm_</tt> for some
time now...)
<p>
Similarly, <tt>trace</tt> is no longer built-in (so you can use the name
if you want to).  You can get <tt>trace</tt> either as <tt>_trace</tt>
(Glasgow extension), or as itself via <tt>import Trace</tt> with
<tt>-syslib hbc</tt> (i.e., exactly like HBC).
<p>
Lazy, or irrefutable, patterns with unboxed-type components are
no longer allowed.  You'll need to rewrite <tt>let (I# x) = exp ...</tt>
as <tt>let x = case exp of \{ I# i -&gt; i \} in ... </tt>.
<p>
GHC now supports hexadecimal and octal numeric syntax for integer constants.
(But <tt>read</tt> doesn't grok it yet...)
<p>
GHC now supports specialised instances (as in HBC); you can write:

<pre>
instance Eq a =&gt; Eq (Foo a) where { ... }
{-# SPECIALIZE instance Eq (Foo Bool) #-}
</pre><p>

GHC's pragmas for specialised values now have a magical <tt>= blah</tt>
form, in which you specify the code to be used for the specialised value.
For example:

<pre>
f :: Ord a =&gt; a -&gt; Int -&gt; a
{-# SPECIALIZE f :: Double -&gt; Int -&gt; Double = f_Double #-}

f_Double :: Double -&gt; Int -&gt; Double
f_Double ...
</pre><p>
In some cases, the <tt>= blah</tt> form can be a <i>big</i> win.
<p>
What we used to call "threaded" Haskell, we now call "Concurrent
Haskell."  And there's a paper about it.  Please see the User's Guide.
<p>
"Parallel Haskell," running under PVM, is here.  Again, see the
User's Guide.
<p>

<a name="0-26-options"><h3>New or changed GHC command-line options</h3></a>

<p>
The <tt>-g</tt>, <tt>-p</tt>, <tt>-pg</tt>, <tt>-fpic</tt>, and <tt>-fPIC</tt> are no
longer passed straight through to GCC.  They probably buy you nothing,
while potentially causing substantial mischief.  If you know what you're doing,
you can still use them, via <tt>-optcO-...</tt>.
<p>
The main option for Concurrent Haskell is <tt>-concurrent</tt>; for
Parallel Haskell, it's <tt>-parallel</tt>.
<p>
The <tt>-dict-all</tt> option, used with <tt>-prof</tt>, has died.  It never
did anything anyway.
<p>
Besides the <tt>-fshow-specialisations</tt> option to see what specialisations
have occurred, you may also use the <tt>-fshow-import-specs</tt> option
to see what specialisations GHC would like to have had available.
By then adding these "desirable" pragmas to your code, you can
squash most of the overloading from your program.
<p>
There are some new sanity-checking options.  Use
<tt>-fsignatures-required</tt> if you want to force all top-level
definitions to have type signatures.  Use <tt>-fshadowing-not-ok</tt>
if you want to disallow name shadowing.  You can't use the latter on
modules that include circular definitions.
<p>
The <tt>-Rghc-timing</tt> option gives a convenient one-line summary to
GHC's runtime and heap allocation.
<p>
The <tt>-odump</tt> option may be used to save GHC's standard-error output
to a file. (It normally shows up on your screen.)
<p>
You can now use <tt>-H0</tt> and <tt>-K0</tt> to reset the heap and stack
sizes.  As these sizes are normally "maxxed up" (<tt>-H32m -H16m</tt>
gets you a 32MB heap), you can use this form to decrease the size:
<tt>-H6m -H0 -H250k</tt> gives you a heap of 250KB.
<p>

<a name="0-26-io"><h3>New in monadic I/O</h3></a>

<p>
GHC 0.26 is still a Haskell 1.2 compiler (and will remain so until
there is a non-DRAFT 1.3 standard).
<p>
We killed the <tt>PreludePrimIO</tt> interface.  You can get all the same
functions from <tt>PreludeGlaST</tt>.
<p>
All the <tt>_IVar</tt> and <tt>_MVar</tt> operations are now in the 1.3
<tt>IO</tt> monad, not the non-standard <tt>PrimIO</tt> monad.  You now
get them from <tt>Concurrent</tt>, not from <tt>PreludeGlaST</tt>.
<p>

<a name="0-26-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
The main new things are "foldr-build" deforestation (by Andy Gill)
and ever-more-glorious specialisation (by Patrick Sansom).
<p>
And the usual few megabytes of gratuitous changes.
<p>

<a name="0-26-new-in-libraries"><h3>In the prelude and libraries</h3></a>

<p>
All of the basic state-transformer stuff now comes from
<tt>PreludeGlaST</tt>.  The <tt>PreludePrimIO</tt> interface no longer exists.
<p>
The function <tt>foldrPrimIO</tt> went away.  The function <tt>forkPrimIO</tt>
sprang to life.
<p>
The what-you-need-for-Concurrent-Haskell interface is <tt>Concurrent</tt>.
The GHC option is <tt>-concurrent</tt>.  Please see the User's Guide.  
Note that the operations <a href="#threadDelay"><tt>threadDelay</tt></a> and <a href="#threadWait"><tt>threadWait</tt></a> now come
from <tt>Concurrent</tt>, not <tt>PreludeGlaMisc</tt>.
<p>
I-Vars and M-Vars (synchronising variables) are now
specifically I/O operations, not general state-transformer operations.
They also come from the <tt>Concurrent</tt> interface.
<p>
Renamings: what used to be the <tt>newMVar</tt> operation is now called
<tt>newEmptyMVar</tt>; what was <tt>initMVar</tt> is now <tt>newMVar</tt>.
<p>
The what-you-need-for-Parallel-Haskell interface is <tt>Parallel</tt>.
The GHC option is <tt>-parallel</tt>.  At the moment, the <tt>Parallel</tt>
interface just provides <tt>par</tt> and <tt>seq</tt>.  But that will change.
<p>
<tt>LibPosix</tt> now provides <tt>runProcess</tt>, our candidate for the
high-level OS-independent operation.
<p>
NEW: The <tt>Regex</tt> (<tt>-syslib ghc</tt>) interface provides direct
access to the GNU regexp (regular expressions on strings) package.
The <tt>MatchPS</tt> interface is higher-level, providing string-matching
functions on <tt>_PackedStrings</tt>.  (All by Sigbjorn Finne)
<p>
NEW: The <tt>Readline</tt> interface (also <tt>-syslib ghc</tt>) provides
access to the GNU readline package.  Instant command-line editing
for your Haskell programs.  (By Darren Moffat)
<p>
NEW: A "network interface toolkit" by Darren Moffat.  BSD sockets
for Haskell -- way cool.
<p>
The <tt>FiniteMap</tt> module has two new functions, <tt>isEmptyFM</tt> and
<tt>elemFM</tt>.
<p>
The <tt>Maybes</tt> module now uses the Haskell 1.3 built-in <tt>Maybe</tt>
type; you should use <tt>-fhaskell-1.3</tt> with this module now.
<p>
The HBC library modules <tt>Maybe</tt>, <tt>Either</tt>, and <tt>Option</tt> are
<i>gone</i>.  Just use <tt>-fhaskell-1.3</tt> and get the types directly
from the Prelude.
<p>
All system-library modules that use the <tt>Maybe</tt> type now require
<tt>-fhaskell-1.3</tt>.  For the GHC library, that means <tt>FiniteMap</tt>,
<tt>Maybes</tt>, <tt>Util</tt>, <tt>Set</tt>, <tt>Regex</tt>, and <tt>MatchPS</tt>.  For
the HBC library, that means <tt>ListUtil</tt>, <tt>Native</tt>, and
<tt>Parse</tt>.  (In some cases, you could avoid the <tt>-fhaskell-1.3</tt>
requirement by doing selective imports.)
<p>
GHC now supports <tt>trace</tt> exactly like HBC: <tt>import Trace</tt> and
do <tt>-syslib hbc</tt>.  The built-in no-import-required version
is now called <tt>_trace</tt>.
<p>
Instances for <tt>Shorts</tt> and <tt>Bytes</tt> have been added to the
HBC library module <tt>Word</tt>.
<p>
As part of the GHC system library, we now provide an interface to the
GNU regexp (regular-expression) library; the <tt>Regexp</tt> interface.
A higher-level interface, to do matches on <tt>_PackedString</tt>s comes
from the <tt>MatchPS</tt> interface.
<p>
We no longer provide specialisations of Prelude functions to the
<tt>Float</tt> type; only to <tt>Double</tt>.  It saves space, and we want to
discourage the use of single-precision floating-point.
<p>

<a name="0-26-new-in-rts"><h3>In the runtime system</h3></a>

<p>
GHC now supplies some very simple "hooks" to let you change the
failure messages for stack and heap overflow, <tt>error</tt>, and
pattern-matching failure.  Please see the User's Guide.
<p>
You can now force garbage collection after every N bytes of allocation
(presumably for stats collection, or something).  Use the <tt>-j</tt> RTS
option.
<p>
"Squeezing out" update frames at garbage-collection time is now <i>on</i> by default.  (You can turn it off with the <tt>-Z</tt> RTS option, but
I can't think why you would want to.)
<p>

<a name="0-26-new-elsewhere"><h3>Other new stuff</h3></a>

<p>
The GHC distribution now includes an "examples" directory, including
a simple shell (<tt>hsh</tt> and quite a few to do with 1.3 I/O
(<tt>ioNNN</tt>) and <tt>LibPosix</tt> (<tt>poNNN</tt>).  All in
<tt>ghc/misc/examples</tt>...




<p>

<a name="release_2"><h2>Non-release notes for versions 0.24 and 0.25</h2></a>
Version 0.24 (March 1995) was a tidy-up release; it mostly
fixed some "threads" problems (now "Concurrent Haskell"),
some I/O problems, and some porting problems.
<p>
Version 0.25 was a binary-only dump of a <tt>i386-*-linuxaout</tt>
build, just so people could try it.
<p>

<a name="release-0-23"><h2>Release notes for version 0.23 -- 12/94</h2></a>
Release 0.23 is the fifth public release of Glasgow Haskell.
It incorporates our new work for the second half of 1994.
<p>
The announcement for this release is distributed as <tt>ANNOUNCE-0.23</tt>
in the top-level directory.
<p>

<a name="0-23-ports"><h3>What machines GHC 0.23 runs on</h3></a>

<p>
NOTE: the porting situation is essentially unchanged between 0.22 and
0.23, except for adding the native-code generator for DEC Alphas.
<p>
We use Sun4s running SunOS 4.1.3 and DEC Alphas running OSF/1 V2.0, so
those are the "fully-supported" platforms, unsurprisingly.  Both
have native-code generators, for quicker compilations.
<p>
The GHC hierarchy of Porting Goodness: (a) Best is a native-code
generator; (b) next best is a "registerised"
port; (c) the bare minimum is an "unregisterised" port.
"Unregisterised" Haskell programs are much bigger and slower,
but the port is much easier to get going.
<p>
Here's everything that's known about GHC ports, as of 0.23:
<dl>
<p>
<dt>Sun4 running SunOS 4.1.3 (<tt>sparc-sun-sunos4</tt>):
<dd>Fully supported, including native-code generator.
<p>
<dt>Sun4 running Solaris 2.x (<tt>sparc-sun-solaris2</tt>):
<dd>Fully supported, including native-code generator.
(NB: not tested before release.)
<p>
<dt>DEC Alpha running OSF/1 V2.0 (<tt>alpha-dec-osf1</tt>):
<dd>Fully supported, including native-code generator.
<p>
<dt>Sun3 running SunOS 4.1.3 (<tt>m68k-sun-sunos4</tt>):
<dd>GHC 0.23 works registerised.  No native-code generator.
<p>
<dt>HP-PA box running HP/UX 9.x:
<dd>An unregisterised port of 0.21 (last "internal" release before 0.23)
seems to work, except that floating-point is definitely busted.
0.23 should be the same.
<p>
<dt>Silicon Graphics box running IRIX 5.x:
<dd>An unregisterised port of 0.21
seemed to work.  0.23 should be the same.
<p>
<dt>DECstation (MIPS-based):
<dd>An unregisterised port back around the time of 0.17 seemed to work;
0.23 should be the same, modulo a little bit-rot.
<p>
<dt>x86 PCs running Linux/NetBSD/FreeBSD:
<dd>This really needs a native-code generator to be viable.  No
recent progress.
<p>
<dt>GRIP multiprocessor:
<dd>GRIP is a 68020-based multiprocessor for running parallel Haskell
programs; too bad we have the only machine!  We run GHC 0.16 on it,
with no plans to upgrade.
<p>
We are working on other parallel stuff.  Stay tuned.
<p>
<dt>NeXT box running whatever NeXTs run:
<dd>Carsten Schultz succeeded with a "registerised" port of GHC 0.19.
There's probably a little bit-rot since then, but otherwise it should
still be fine.  Had a report that things were basically OK at 0.22.
<p>
<dt>Macintosh, using MPW:
<dd>As mind-blowing at it may seem, David Wright in Tasmania has actually
gotten GHC to run on a Macintosh.  Ditto James Thomson here at Glasgow.
You may be able to get Thomson's from here.  (Not sure that it will
excite you to death, but...)
</dl>
<p>

<a name="0-23-config"><h3>New configuration things in 0.23</h3></a>

<p>
Essentially, upgraded to Autoconf 2.  Probably the easiest way to see
what all the options are now is to type <tt>./configure --help</tt> and
look at the stuff near the end.
<p>

<a name="0-23-user-visible"><h3>User-visible changes in 0.23, including incompatibilities</h3></a>

<p>
You'll need to recompile everything if you're switching from a
previous version of GHC.  (If you don't, you'll get "consistency
errors".)  Some day, we will stop doing this to you :-)
<p>
Monadic I/O has taken yet another shake-up; that is outlined in the
next section.
<p>
To use the 1.3-DRAFT I/O features, you use a <tt>-fhaskell-1.3</tt> flag.
This also nets you, from your Prelude, the <tt>Maybe</tt> and <tt>Either</tt>
types, and the functions <tt>thenMaybe</tt>, <tt>curry</tt>, and <tt>uncurry</tt>.
<p>
The driver supports a heap-and-stack-sizes scaling flag.  For example,
<tt>-Rscale-sizes2</tt> would cause the driver to use twice as much
heap/stack space as it would otherwise.  This is a convenient way to
move between machines with differing memory setups (e.g., 32-bit vs
64-bit) without changing millions of -H flags in a Makefile.  Note:
something like <tt>-Rscale-sizes1.5</tt> is OK, too.
<p>
"Lit-lit" literals are now overloaded.  They can be any
<tt>_CCallable</tt> type, not just <tt>_Addrs</tt>.  The price of this extra
convenience is that you sometimes have to insert a type signature.
<p>
The shift-right primitive-operation, <tt>shiftR#</tt>, has been renamed
and clarified to <tt>shiftRA#</tt> (arithmetic).  A new prim-op
<tt>shiftRL#</tt> (logical) has been added.
<p>
Comparable shift primitive-ops on <tt>Int#s</tt> (rather than <tt>Word#s</tt>)
have been added: <tt>iShiftL#</tt>, <tt>iShiftRA#</tt>, and <tt>iShiftRL#</tt>.
Long live high-level languages!
<p>

<a name="0-23-io"><h3>New in I/O, esp. "monadic," esp. "1.3"</h3></a>

<p>
GHC 0.23 is still a Haskell 1.2 compiler.  Do nothing weird, and it
should work exactly as before.
<p>
If you give GHC a <tt>-fhaskell-1.3</tt> flag (both compile and link time,
please!), it will use a VERY EARLY, LARGELY UNTESTED implementation of
the DRAFT 1.3 I/O PROPOSAL.
<p>
The <tt>PreludeGlaIO</tt> interface, which was based on a long-ago 1.3 I/O
proposal, is DEAD.  It was in a pretty bad state, anyway.
Putting <tt>PreludeGlaIO</tt> code through as 1.3 code, I got pretty
far with just these few impedance-matching definitions:

<pre>
&gt; type Void = ()
&gt; returnIO = return
&gt; thenIO = (&gt;&gt;=)
&gt; mapIO  :: (a -&gt; IO b) -&gt; [a] -&gt; IO [b]
&gt; mapIO f =  accumulate {-was:listIO-} . map f
</pre><p>

We supply the DRAFT 1.3 I/O PROPOSAL in <tt>ghc/docs/io-1.3/</tt>.
It is in HTML format.
<p>
We still give access to our underlying <tt>PrimIO</tt> monad, via the
<tt>PreludePrimIO</tt> interface.  This is the level at which <tt>_ccall_s</tt>
operate.  It should still be quite solid, and counts as a good fall-back
position when the 1.3-DRAFT stuff dies on you.  See the User's Guide.
<p>

<a name="0-23-support"><h3>New in support tools (e.g., profiling)</h3></a>

<p>
The reports from profiling should be a bit tidier.  The "automagic"
cost-centres for, e.g., "all the CAFs in module X", will now be
reported against <tt>CAFs_in_... X</tt>.  Which seems fair enough.
<p>
GHCI -- an INTERPRETER for Glasgow Haskell!  The brainchild and work of
Alastair Reid, before he defected to the Enemy at Yale.  Accepts full
Glasgow Haskell, including many extensions.  Can mix interpreted and
compiled code, the Prelude being a notably case of the latter.
MASSIVE HACK VALUE!  The problem is it doesn't quite compile under
0.23 (I ran out of time), and some of its dodgy bits (used to mix
interpreted and compiled code) need upgrading to work with the new
info tables.  It lives in <tt>ghc/compiler</tt> and below, notably the
<tt>interpreter</tt> subdirectory.  Don't be shy now -- roll up your
sleeves and strut your hacking stuff!
<p>

<a name="0-23-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
The compiler is quite a bit faster at compiling, <i>without</i>
<tt>-O</tt>.  We are in the HBC league now.  I don't remember all the
HACKs that we threw in to make this happen :-)
<p>
New-format "info tables" (work by Bryan O'Sullivan and friends).
Essentially, static info used by the garbage-collector has been moved
one indirection further away, into a "rep table," of which there are
a fixed number.  So the same GC info isn't replicated over and over
again.  This is our main space-savings gain in 0.23.
<p>
A native-code generator for the DEC Alpha.  Jim Mattson did it in one
weekend.  What a great system!
<p>
Rather than have a separate Yacc-parser process that spews a long
"prefix form" string into the compiler, the compiler now just does a
<tt>_ccall_ yyparse</tt> and then walks the resulting parse tree directly.
(Not quite <i>that</i> simple, but... still pretty cool.)
<p>
A <i>selective</i> lambda-lifter.  (Simon is very excited about its
selectiveness.)  That means it only does lambda-lifting if there is a
benefit in doing so.  It's done on the STG syntax (quite late in the
compilation).
<p>

<a name="0-23-new-in-libraries"><h3>In the prelude and runtime support</h3></a>

<p>
PackedStrings (now called <tt>_PackedString</tt>s) are now a built-in
type, just like <tt>Int</tt>s, say.  Their interface is described with the
Glasgow extensions in the User's Guide.  There is also a
"extensions-free" interface (no underscores on the front of names)
which you can get at as a system library (<tt>-syslib ghc</tt>).
<p>
The pretty-printing code that we use in GHC is now available in the
GHC system library (<tt>-syslib ghc</tt> and <tt>import Pretty</tt>).  We
would claim it is more "industrial strength" than the one in the HBC
system library...
<p>
Because of name-grabbing by the DRAFT-1.3-I/O, two functions in the
HBC library's <tt>Parse</tt> module have been renamed: <tt>(&gt;&gt;)</tt> is now
<tt>act</tt>, and <tt>fail</tt> is now <tt>failP</tt>.  (We will change these
again if Lennart does something differently.)
<p>

<a name="0-23-new-elsewhere"><h3>Other new stuff</h3></a>

<p>
We've added a new utility, <tt>pphs</tt>, for pretty-printing Haskell code
in LaTeX documents.  It was written by Andrew Preece, a student at
Glasgow.  The code is in <tt>ghc/CONTRIB/pphs</tt>.
<p>
Over in literate-land, we've hidden a copy of a slightly-tweaked
<tt>texi2html</tt> script (in <tt>literate/texi2html/texi2html</tt>).  This is
probably the most painless way to turn "literate" things into
Webbable HTML documents.  (Use our literate stuff to make Texinfo
files, then convert with <tt>texi2html</tt>.)  NB: not really tested.




<p>

<a name="release-0-22"><h2>Release notes for version 0.22 -- 7/94</h2></a>
Release 0.22 is the fourth public release of Glasgow Haskell.
It incorporates our new work for the first half of 1994.
<p>
The announcement for this release is distributed as <tt>ANNOUNCE-0.22</tt>
in the top-level directory.
<p>

<a name="0-22-ports"><h3>What machines GHC 0.22 runs on</h3></a>

<p>
We use Sun4s running SunOS 4.1.3 and DEC Alphas running OSF/1 V2.0, so
those are the "fully-supported" platforms, unsurprisingly.  For
Sun4s, we have a native-code generator, which makes for somewhat
quicker compilations.  (We actually produce better code by compiling
intermediate C with GCC.)
<p>
The GHC hierarchy of Porting Goodness: (a) Best is a native-code
generator [only for Sun4s, now]; (b) next best is a "registerised"
port; (c) the bare minimum is an "unregisterised" port.
"Unregisterised" Haskell programs are much bigger and slower,
but the port is much easier to get going.
<p>
Here's everything that's known about GHC ports, as of 0.22:
<dl>
<p>
<dt>Sun4 running SunOS 4.1.3:
<dd>Fully supported, including native-code generator.
<p>
<dt>DEC Alpha running OSF/1 V2.0:
<dd>Fully supported, but no native-code generator (none planned).
<p>
<dt>Sun3 running SunOS 4.1.3:
<dd>GHC 0.22 should work, registerised.  (0.21 did work.)
<p>
<dt>Sun4 running Solaris 2.x:
<dd>We expect to finish a "registerised" port ourselves, in the
foreseeable future.  Feel free to ask about it, if interested.  Not
sure about native-code...
<p>
<dt>HP-PA box running HP/UX 9.x:
<dd>An unregisterised port of 0.21 (last "internal" release before 0.22)
seems to work, except that floating-point is definitely busted.
0.22 should be the same.
<p>
<dt>Silicon Graphics box running IRIX 5.x:
<dd>An unregisterised port of 0.21
seemed to work.  0.22 should be the same.
<p>
<dt>DECstation (MIPS-based):
<dd>An unregisterised port back around the time of 0.17 seemed to work;
0.22 should be the same, modulo a little bit-rot.
<p>
<dt>x86 PCs running Linux/NetBSD/FreeBSD:
<dd>This really needs a native-code generator to be viable.  No
recent progress.
<p>
<dt>GRIP multiprocessor:
<dd>GRIP is a 68020-based multiprocessor for running parallel Haskell
programs; too bad we have the only machine!  We run GHC 0.16 on it,
with no plans to upgrade.
<p>
We are working on other parallel stuff.  Stay tuned.
<p>
<dt>NeXT box running whatever NeXTs run:
<dd>Carsten Schultz succeeded with a "registerised" port of GHC 0.19.
There's probably a little bit-rot since then, but otherwise it should
still be fine.
<p>
<dt>Macintosh, using MPW:
<dd>As mind-blowing at it may seem, David Wright in Tasmania has actually
gotten GHC to run on a Macintosh.  Ditto James Thomson here at Glasgow.
You may be able to get Thomson's from here.  (Not sure that it will
excite you to death, but...)
</dl>
<p>

<a name="0-22-user-visible"><h3>User-visible changes in 0.22, including incompatibilities</h3></a>

<p>
You'll need to recompile everything if you're switching from a
previous version of GHC.  (If you don't, you'll get "consistency
errors".)
<p>
Lazy pattern-matching (e.g., <tt>let (x,y) = ... in ...</tt>) no longer
carries with it the threat of a space leak.  (It used to be that, as
long as <i>either</i> of <tt>x</tt> or <tt>y</tt> was "live," the storage
manager would hang onto <i>both</i> chunks of graph.)  No longer.
<p>
We've done a complete overhaul of the state-transformer stuff which
underlies our array, I/O, and C-calling support.  The "state
interface document," distributed in <tt>ghc/docs/state-interface.dvi</tt>
defines what we have done.  You may wish to check our abstracts
(<tt>ghc/docs/abstracts/</tt>) to find papers about this stuff.  If you've
written code that grovels around in GHC innards (e.g., uses
"primitive operations" directly), it will probably need updating.
<p>
We do <i>not</i> support Haskell 1.3 monadic I/O (any draft version),
but we will once the dust settles.  We still support the
<tt>PreludeGlaIO</tt> interface that we have had for some time.
<p>
You can now build GHC to support "threaded" execution.  (Configure
<tt>--with-threads=yes</tt>, then use GHC with a <tt>-threads</tt> option.)
Using the <tt>_seq_</tt> and <tt>_par_</tt> constructs,
<p>
GHC does a better job of not stealing from the user's name space (for
its own extensions, etc.).  For example, the "set cost-centre"
keyword is now <tt>_scc_</tt>, rather than <tt>scc</tt> (though the latter
will continue to be accepted for a while).  With the
<tt>-fglasgow-exts</tt> flag on, names may begin with an underscore
(<tt>_</tt>).
<p>
We have friendly interaction between "Haskell land" and "C land"
via (a) <i>stable pointers</i> (pass Haskell pointers to C and have the
garbage-collector not forget about them); and (b) <i>malloc
pointers</i> (return C pointers to Haskell and tell Haskell "throw this
away when you're finished with it").  See the User's Guide for more
info.
<p>

<a name="0-22-support"><h3>New in support tools (e.g., profiling)</h3></a>

<p>
The profiling system of GHC has been improved in version 0.22 in the
following ways:
<dl>
<dt>Now uses the "hybrid scheme":
<dd>(Rather than pure "lexical
scoping") What this means for you: "CAF" cost-centres will no
longer be blamed for gigantic chunks of the time in your program.
<p>
<dt>Uses the generational garbage-collector:
<dd>(At least when doing
time profiling)  It used to use a two-space copying GC; it still does
when space profiling.  You should be able to profile larger programs.
</dl>
<p>

<a name="0-22-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
The "simplifier" -- the program-transformation engine in the middle
of the compiler -- has settled down (at least until Simon has another
Brain Wave).  We've made "per-simplification" flags, so that each
run of the simplifier can be controlled separately -- this allows very
precise control.  (But makes it pretty hard to exercise any control
from the command-line.)  More in the docs.
<p>
Related to simplifier stuff was a revision of the "unfoldery"
machinery.  We try very hard to find and exploit unfolding (or
inlining), including across module boundaries.
<p>

<a name="0-22-new-in-libraries"><h3>In the prelude and runtime support</h3></a>

<p>
We've introduced a "GHC system library," similar to the "HBC system
library" which we have supported for some time.  Just say
<tt>-syslib ghc</tt> and the GHC library stuff is at your fingertips.
See the User's Guide for exactly what's on offer (not a lot right now,
but more will show up).
<p>
The <a href="#PackedString"><tt>PackedString</tt></a> module that comes with the system is even beefier
than before; see the User's Guide.  (This module really should be
in the GHC library.)
<p>

<a name="0-22-new-elsewhere"><h3>Other new stuff</h3></a>

<p>
We have two new mailing lists about Glasgow Haskell.
<dl>
<dt>glasgow-haskell-users:
<dd>This list is for GHC users to chat among themselves.  Subscribe by
sending mail to <tt>glasgow-haskell-users-request@dcs.glasgow.ac.uk</tt>.
Messages for the list go to <tt>glasgow-haskell-users</tt>.
<p>
<dt>glasgow-haskell-bugs:
<dd>This used to be an address for some lonely person who received bug
reports.  It is now a mailing list for the sort of people who discuss,
well, bug reports when they go to a party.
<p>
Subscribe via <tt>glasgow-haskell-bugs-request@dcs.glasgow.ac.uk</tt>;
send bug reports and rumination thereupon go to
<tt>glasgow-haskell-bugs</tt>.
</dl>




<p>

<a name="release-0-19"><h2>Release notes for version 0.19 -- 12/93</h2></a>
Release 0.19 was the third public release of this compilation system.
It incorporates our new work for the last half of 1993.
<p>
The announcement for this release is distributed as <tt>ANNOUNCE-0.19</tt>
in the top-level directory.
<p>

<a name="0-19-user-visible"><h3>User-visible changes in 0.19, including incompatibilities</h3></a>

<p>
You'll need to recompile everything if you're switching from a
previous version of GHC.  (If you don't, you'll get "consistency
errors".)
<p>
Default declarations: in.
<p>
Derived instances of <tt>Ix</tt> and <tt>readsPrec</tt> (<tt>Text</tt> class): in.
(Random Prelude instances of weird things: in.)  You can avoid the
<tt>readsPrec</tt> methods by using the <tt>-fomit-derived-read</tt> option.
<p>
Should be <i>faster</i>, for two reasons: (1) A native-code generator
for the SPARC architecture (avoids C compilation time); (2) an
array-based [vs naive list-based...] substitution mechanism in the
typechecker.  Using <tt>-O2</tt> or <tt>-fvia-C</tt> avoids the native-code
generator.
<p>
(Shouldn't be too much faster, because we spent a lot of the winnings
:-()
<p>
<tt>MkInt</tt> and friends <i>renamed</i>: <tt>MkInt</tt>, <tt>MkChar</tt>,
<tt>MkFloat</tt>, <tt>MkDouble</tt>, and <tt>MkInteger</tt> are now <tt>I#</tt>,
<tt>C#</tt>, <tt>F#</tt>, <tt>D#</tt>, and <tt>J#</tt>, respectively.
We won't change them again, we promise.
<p>
<tt>-i</tt>/<tt>-I</tt> flags changed: You used to specify directories to
search for interface files with <tt>-I &lt;dir&gt;</tt>; now you do it with
<tt>-i&lt;dir&gt;</tt> [<i>no space after the <tt>-i</tt></i>] (same as HBC).
<tt>-I</tt> is reserved for when doing <tt>-cpp</tt> and for the C compiler,
when it is run.
<p>
Renaming, feature horribilis that it is, is more-or-less fully
implemented.  The User's Guide lists one or two exceptions.
<p>
Specialised versions of overloaded functions: these are created
automagically with <tt>-O</tt>, and also when you ask for them with
<tt>SPECIALIZE</tt> pragmas.  See the User's Guide for how to do this
(same as HBC).  (We don't have specialised instance declarations yet.)
<p>
GHC tries hard to do inlining (or "unfolding") across module
boundaries; just look at <tt>-O</tt>-produced interface files.  You can
enliven this process with <tt>INLINE</tt> pragmas.
<p>
The <tt>__GLASGOW_HASKELL__</tt> CPP directive is only set when
pre-processing Haskell source (and not when pre-processing generated
C).
<p>
Revised scheme for using system-provided libraries (e.g., the HBC
library).  Just use a <tt>-syslib &lt;name&gt;</tt> option when compiling and
linking.  See the User's Guide for details.
<p>

<a name="0-19-new-docs"><h3>New documentation</h3></a>

<p>
See <tt>ghc/docs/README</tt> for a full list of documentation.
<p>
The updated User's Guide has new sections including: (a) advice for
creating smaller and faster programs more quickly, and (b) about the
HBC library [stolen documentation].
<p>
We've dropped papers from the distribution (they're big, and you can
get them easily anyway); instead, we provide abstracts of all
documents about all relevant work at Glasgow; see
<tt>ghc/docs/abstracts</tt>.
<p>
New: "A Simple Country Boy's Guide to Monadic-Style Programming" (Will
Partain).  In <tt>ghc/docs/simple-monad.lhs</tt>.
<p>

<a name="0-19-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
Strictness analyser: produces/handles "nested" strictness -- e.g.,
<tt>U(SLL)</tt> means "this single-constructor argument is strict, and it
is also strict in its first component."  There's also "absence
analysis" in there: <tt>U(ASA)</tt> means "strict in the second
component, and the first/third are not used at all."
<p>
New simplifier: the program-transformation engine in the middle of the
compiler.  The "old simplifier," primarily the work of Andre
Santos, has retired to an Old Simplifier's Home on the coast of
Brazil, where it is collecting a well-deserved monadic pension.
<p>

<a name="0-19-new-in-libraries"><h3>In the prelude and runtime support</h3></a>

<p>
A couple of new functions in the <a href="#PackedString"><tt>PackedString</tt></a> module that comes with
the system.  Mentioned in the User's Guide.
<p>
The HBC library has been upgraded to match the latest HBC release
(0.999.5).  We now support the <tt>Native</tt> and <tt>NameSupply</tt>
modules, which we didn't before.
<p>
Alastair Reid's implementation of "stable pointers," which he uses
to do callbacks with the X Window System (yow!), is in.  I (WDP) don't
know about documentation.... send mail if you need to know.
<p>

<a name="0-19-new-ports"><h3>In the porting department</h3></a>

<p>
We use Sun4s running SunOS 4.1.3, so those are the best-supported
machines.  For these, we have a native-code generator (the best); next
best is a "registerised" port; the bare minimum is an
"unregisterised" port.
<p>
The 0.19 infrastructure for "stealing" registers for a registerised port
(using a GCC extension) is much more robust -- take note, brave porters.
<p>
Here's everying that's known about the porting world:
<dl>
<p>
<dt>Sun3 running SunOS 4.1.3:
<dd>A registerised port is done; could be made available.
<p>
<dt>GRIP multiprocessor:
<dd>68020-based multiprocessor for running parallel Haskell programs.
A registerised port is done; too bad we have the only machine!
If you have something parallel you <i>really</i> wanted to run on it,
please get in touch with us.
<p>
<dt>HP-PA box running HP/UX:
<dd>An unregisterised port of 0.17 (0.16+portability fixes) seems to
work, except that floating-point is definitely busted.  0.19 should be
no worse.
<p>
<dt>DECstation (MIPS-based):
<dd>An unregisterised port of 0.17 works; 0.19 should be the same.
<p>
<dt>DEC Alpha running OSF/1:
<dd>We've done an unregisterised port (unreleased), and a registerised
port is not far off.
<p>
<dt>Sun running Solaris 2.x:
<dd>We've started on this ourselves and foresee no obstacle to a
"registerised" port.  Not sure about native-code...
<p>
<dt>x86 PCs running Linux:
<dd>This really needs a native-code generator to be viable.  We hope the
elves will give us one for Christmas!
<p>
<dt>Macintosh, using MPW:
<dd>As mind-blowing at it may seem, David Wright in Tasmania has actually
gotten GHC to run on a Macintosh.  I believe it's still in the "you
can do it, but you don't want to" stage.
</dl>
<p>

<a name="0-19-new-elsewhere"><h3>New elsewhere</h3></a>

<p>
In the "literate programming" stuff that happens to come with GHC: a
few bug fixes, plus a significant contribution from Chris Toshok
(<tt>toshok@cs.uidaho.edu</tt>) of "lit2html" stuff; i.e., to convert
your literate programs into HTML, the Hypertext Markup Language used
on the World-Wide Web.  I (WDP) am not sure it's completely finished,
or exactly what you invoke to do what, but it seems Way Cool.




<p>

<a name="release-0-16"><h2>Release notes for version 0.16 -- 07/93</h2></a>
Release 0.16 was the second public release of this compilation system.
It was primarily a bug-fixing and "solidifying" release.
<p>
The announcement for this release is distributed as <tt>ANNOUNCE-0.16</tt>
in the top-level directory.
<p>

<a name="0-16-new-docs"><h3>New documentation</h3></a>

<p>
We're providing a few more papers, in <tt>ghc/docs/papers</tt>.  See
<tt>ghc/docs/README</tt> for a full list of documentation.
<p>

<a name="0-16-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
New strictness analyser and update analyser; their use will be
reflected in the pragmas in your interface files.  The format of these
interface pragmas <i>will probably change</i>.
<p>
Errors related to misuse of Prelude identifiers are more likely to be
caught.
<p>
For some unknown reason, our "wired-in" default declaration in 0.10 was
<tt>default (Integer,Double)</tt>.  We changed it to
<tt>default (Int,Double)</tt>, as the Report suggests (which is less safe).
<p>
We've switched from basing our derived instances on a non-standard
<a href="#cmp3"><tt>cmp3</tt></a> method (class <a href="#Ord"><tt>Ord</tt></a>), to basing them on another non-standard
method <a href="#tagCmp"><tt>tagCmp</tt></a>.  The relevant types and things are...

<pre>
cmp3 :: b -&gt; b -&gt; b -&gt; a -&gt; a -&gt; b

tagCmp :: a -&gt; a -&gt; CMP_TAG
data CMP_TAG = LT_TAG | EQ_TAG | GT_TAG
</pre><p>
If you peer into the <tt>ghc/lib/prelude/*.hs</tt> code, it will be
obvious what's going on here.  We hope to make further improvements
on comparison code in the foreseeable future.
<p>

<a name="0-16-new-in-libraries"><h3>In the prelude and runtime support</h3></a>

<p>
The libraries underpinning Glasgow monadic I/O, sequencing, primitive
arrays, and variables have been reworked, with some consequent
changes.  If you encounter difficulties, you should consult the
<a href="#PreludeGlaIO.hi"><tt>PreludeGlaIO.hi</tt></a> and <a href="#PreludeGlaArray.hi"><tt>PreludeGlaArray.hi</tt></a> interfaces in your
<tt>imports</tt> directory.
<p>
Andy Gill's proposal for access to standard Haskell I/O functions from
the monadic I/O world has been implemented.  So you have functions
such as <a href="#getArgsIO"><tt>getArgsIO</tt></a>, <a href="#appendChanIO"><tt>appendChanIO</tt></a>, etc., etc.
<p>
The stuff you used to get from <a href="#Stdio.hi"><tt>Stdio.hi</tt></a> now comes directly from
<a href="#PreludeGlaIO.hi"><tt>PreludeGlaIO.hi</tt></a>.
<p>
The <a href="#packString#"><tt>packString#</tt></a> function has been moved into a module of its own,
<a href="#PackedString"><tt>PackedString</tt></a>, and <i>its type has changed</i>.  The functions now in
that module are (to be elaborated...):

<pre>
packString  :: String -&gt; PackedString
packString# :: String -&gt; Arr# Char#
</pre><p>
The latter is very useful to preparing <a href="#String"><tt>String</tt></a> arguments to pass to C.
<p>
The HBC library modules that compile readily with GHC are available,
you'll need to give a <tt>-lHShbc</tt> option to the driver.  These
modules are:

<pre>
Either, Hash, ListUtil, Maybe, Miranda, Number, Parse, Pretty, QSort,
Random, Time, Word
</pre><p>

The GNU multi-precision (GMP) package which underpins our <a href="#Integer"><tt>Integer</tt></a>
support has been upgraded to version 1.3.2.
<p>

<a name="0-16-new-elsewhere"><h3>New elsewhere</h3></a>

<p>
0.16 has a new and much uglier "assembler mangler"
(<tt>ghc/driver/ghc-asm-*.lprl</tt>), which is what converts GCC-produced
assembly-language output into the stuff you actually run.  Besides
throwing away function prologues/epilogues, it parks "info tables"
next to entry code, and fast-entry code right next to slow-entry code.
<p>
The net effect of this assembler-mangler is that there is <i>very
little runtime penalty</i> for compiling via GCC.
<p>
The way we go about mapping "STG registers" to real machine
registers (<tt>ghc/imports/StgRegs.lh</tt>) is different.  It should be
particularly better for machines with few registers (though we still
don't have a good solution for x86 machines).
<p>
We can now "steal" caller-save registers; in the past, we could only
steal callee-save registers.




<p>

<a name="release-0-10"><h2>Release notes for version 0.10 -- 12/92</h2></a>
Release 0.10 was the first major, public release of this compilation
system.
<p>
The announcement (now distributed in <tt>ghc/docs/ANNOUNCE-0.10</tt>)
describes the most notable features of this release.  These notes,
therefore, just cover some of the fine points...
<p>

<a name="0-10-new-docs"><h3>New documentation</h3></a>

<p>
We're providing a few more papers, in <tt>ghc/docs/papers</tt>.  See
<tt>ghc/docs/README</tt> for a full list of documentation.
<p>

<a name="0-10-new-in-usage"><h3>User-visible changes</h3></a>

<p>
An "Appel-style" generational garbage collector is now the default.
(It used to be a two-space copying collector.)
<p>
The flag to use the unboxery and other Glasgow extensions was
<tt>-funboxed</tt>.  We've changed it to <tt>-fglasgow-exts</tt>.  We may
elaborate this further, eventually...
<p>
(If 0.06 is the last version you looked at, flags/options have changed
a fair bit since then.)
<p>

<a name="0-10-new-in-compiler"><h3>New in the compiler proper</h3></a>

<p>
Derived instances are in, well partly.  We'll put in the rest when
there's a demand (or we have nothing better to do).
<p>
<a href="#Integers"><tt>Integers</tt></a> (arbitrary-precision integers) are now in properly.
Just as HBC does, we use the GNU multi-precision arithmetic package.
Source is in <tt>ghc/runtime/gmp</tt>.
<p>
We did a bunch of stuff in the typechecker region to support
overloading better; we called it "dictionary stomping."  One
side-effect of this work is that error messages related to overloading
have a slight chance of being sensible (which they weren't before).
<p>
"Primitive arrays," on top of which efficient, regular Haskell
arrays can be (are) built, went in.  There's a <i>little</i> about
using them, in the "Glasgow extensions" section of the User's Guide.
<p>
Similarly, the mechanisms for calling C directly (<a href="#ccall"><tt>ccall</tt></a> and <a href="#casm"><tt>casm</tt></a>)
are more likely to be useful.  Again, a little documentation in the
same place...
<p>

<a name="0-10-new-in-libraries"><h3>In the prelude and runtime support</h3></a>

<p>
Our standard prelude conforms to the Haskell 1.2 report.
<p>
We support a non-standard <a href="#fromInt"><tt>fromInt</tt></a> method for the <a href="#Num"><tt>Num</tt></a> class, just as
HBC does.
<p>
We support a non-standard <a href="#cmp3"><tt>cmp3</tt></a> method for the <a href="#Ord"><tt>Ord</tt></a> class.  Snoop
around in the <tt>ghc/lib/prelude/*.hs</tt> code, if you care.  (We use it
in code generated for derived instances.)




<p>

<a name="release-0-09"><h2>Release 0.09 -- 9/92</h2></a>

This was an unannounced pseudo-release to a few people.
<p>

<a name="release-0-08"><h2>Release notes for version 0.08 -- 7/92</h2></a>
0.08 was not an announced release, so these notes are of historical
interest, at best.
<p>

<a name="0-08-new-docs"><h3>New documentation, especially for hackers!</h3></a>

<p>

<a name="0-08-new-in-usage"><h3>Main user-visible changes</h3></a>

<p>
<dl>
<p>
<dt><a href="#ghc"><tt>ghc</tt></a> driver flag fiddling:
<dd>These things change... A good thing to try is <tt>ghc -help</tt>, unless
of course you think the documentation might be right (in which case
look there :-).
<p>
<dt><a href="#ghc"><tt>ghc</tt></a> driver more "policy-free":
<dd>The driver no longer has great wads of built-in options for its
constituent phases (parser, Haskell compiler, C compiler, etc.).  It
is much easier to configure these (if required) at build time.  A
better idea, which we use, is to wired in very few options, but to use
the "make world" machinery to ensure that the desired (wads of
options) are always passed explicitly.
<p>
<dt>-OC:
<dd>We got rid of the <tt>-OC</tt> flag.
</dl>
<p>

<a name="0-08-new-in-compiler"><h3>To do with the compiler proper</h3></a>

<p>
<dl>
<p>
<dt>"Renamer" is in:
<dd>Essentially, this implements module-system stuff.  Checks for
naming/scoping errors have been moved out of the typechecker into the
renamer, which should be faster.
<p>
<dt>Interface-file (<tt>.hi</tt> file) generation:
<dd>It works.
<p>
<dt>Ambiguous-type resolution:
<dd>It's basically right now, except that we still don't grok <a href="#default"><tt>default</tt></a>
declarations (which we have yet to see in a real Haskell program :-).
<p>
<dt>Smaller C output:
<dd><dt>Code generator:
<dd>Improvements related to the information carried around about closures
(<a href="#ClosureInfo"><tt>ClosureInfo</tt></a> and <a href="#LambdaFormInfo"><tt>LambdaFormInfo</tt></a> types); matches the STG-machine paper.
<p>
CAFs fully supported (notably updatable ones).
<p>
Black-holing (at garbage-collection time) fully supported.
<p>
<dt>Simplifiers:
<dd>Further work on the <a href="#Core"><tt>Core</tt></a>-to-<a href="#Core"><tt>Core</tt></a> local-transformation passes (in
<tt>compiler/simplCore/</tt>).  Also, we have added
some <a href="#STG"><tt>STG</tt></a>-to-<a href="#STG"><tt>STG</tt></a> transformations; for example, floating <a href="#lets"><tt>lets</tt></a>
outward is most conveniently done at the STG level...
<p>
<dt>Cost-centre-style profiling:
<dd><dt>Improvements to basic datatypes:
<dd>Notably to <a href="#Ids"><tt>Ids</tt></a> (<tt>basicTypes/Id.lhs</tt>) and names
(<tt>basicTypes/NameTypes.lhs</tt>).  There is a new compiler-wide class,
<a href="#NamedThing"><tt>NamedThing</tt></a> (<tt>utils/Outputable.lhs</tt>).  Essentially it is easier to
ask of an entity: where did you come from? (e.g., PreludeCore?,
imported?) what are you? (a data-constructor? a dictionary selector?)
what is your original name? where are you going? (exported or not...)
</dl>
<p>

<a name="0-08-new-in-compiler-contrib"><h3>In contributed bits of the compiler</h3></a>

<p>
<dl>
<dt>Evaluation-transformer bits:
<dd>Denis Howe has sent us an initial version (<tt>compiler/evalTran</tt>).
It isn't used by default, but is presumably play-withable...
<p>
This <a href="#Core"><tt>Core</tt></a>-to-<a href="#Core"><tt>Core</tt></a> transformation makes all lets of the form

<pre>
let VAR = eval EXPR in ...
</pre><p>
strict.  <a href="#eval"><tt>eval</tt></a> is a dummy name which is thrown away (i.e., <a href="#eval x = x"><tt>eval x = x</tt></a>).
</dl>
<p>
Please send us <i>your</i> bits for next time!
<p>

<a name="0-08-new-in-libraries"><h3>In <a href="#Prelude"><tt>Prelude</tt></a> and runtime support</h3></a>

<p>
Prelude is 1.2.
<p>
The compiler has basically all of <a href="#PreludeCore"><tt>PreludeCore</tt></a> wired into it (see
<tt>compiler/prelude/</tt>); the rest is brought in with a straightforward
<tt>import Prelude</tt> (which brings in <tt>imports/Prelude.hi</tt>).  [The
old <tt>MiniPrel*</tt> files are dead and unmissed.]
<p>

<a name="0-08-new-in-mkworld"><h3>In distribution/build/installation machinery</h3></a>

<p>
The "make world" machinery has many small improvements.
<p>
It works notably better in a shared-symlink-tree world (which we use
at Glasgow).
<p>
We have abandoned efforts to use one build tree for making object
files for multiple platforms.  We can make simpler Makefiles as a
result.
<p>
There's a new standard setup, called <tt>fast</tt>.  The name is
inappropriate at present, but it is intended to be for people who
value compiled-code-speed above all else (within reason, of course).
<p>

<a name="0-08-new-misc"><h3>Miscellaneous new things</h3></a>

<p>
New version of Denis Howe's <tt>mira2hs</tt> script.




<p>

<a name="release-0-07"><h2>Release 0.07</h2></a>

This was an unannounced pseudo-release to a few people.
<p>

<a name="release-0-06"><h2>Release notes for version 0.06 -- 3/92</h2></a>
The really new thing about release 0.06 is this: if you can get
your program through the compiler, then it should actually work when you
run it! 
<p>
Another thing we have worked hard on recently is <i>documentation</i> (see
next section).
<p>

<a name="0-06-new-docs"><h3>New documentation, especially for hackers!</h3></a>

<p>
See the file <tt>docs/README</tt> for a full "roadmap" to all known
documentation.
<p>
<dl>
<p>
<dt>STG-machine paper.
<dd>A monster (70+-page) paper which gives a detailed description of the 
Spineless Tagless G-machine, on which the back end of the compiler is based.
Simon is Jolly Proud of this paper.
<p>
This paper isn't in the distribution, but is available by asking
Simon, or by FTP from <tt>ftp.dcs.glasgow.ac.uk:pub/glasgow-fp/stg.dvi</tt>.
<p>
<dt><tt>imports/SMinterface.lh</tt>.
<dd>The storage manager is carefully isolated from the rest of the runtime
system behind a carefully identified interface.  This paper documents
the interface, and says a little about the implementation.  NB:
"literate" <tt>.h</tt> file!
<p>
<dt><tt>docs/C_optimisation</tt>.
<dd>Lots of details about how we use C as a target language, and
the tricks we use to make it go fast.  Still drafty.
<p>
<dt><tt>docs/runtime</tt>.
<dd>The <i>beginnings</i> of a description of details of the runtime system
which aren't covered by the STG paper above.
<p>
<dt><tt>docs/typecheck</tt>.
<dd>The <i>beginnings</i> of a description of tricky corners of the type checker.
<p>
<dt><tt>docs/arrays</tt>.
<dd>A work-in-progress on how to handle arrays properly.
<p>
<dt><tt>docs/core-overview</tt>:
<dd>The beginnings of a description of the Core data type, plus the other
data types you need to know about to write programs which manipulate
the Core data type.
<p>
The "how to add to the compiler" document
(<tt>docs/add_to_compiler</tt>) has some of this stuff in it, too.
<p>
<dt>Type classes paper:
<dd>This is a short (20-page) form of the massive "Static Semantics of
Haskell" paper.  We submitted it to Lisp and FP 1992, but they
(unaccountably) rejected it.
<p>
This paper isn't in the distribution; please ask for it.
</dl>
<p>

<a name="0-06-new-in-compiler"><h3>To do with the compiler proper</h3></a>

<p>
<dl>
<p>
<dt>1.2 syntax:
<dd>The parser handles the Haskell syntax given in the Haskell report,
version 1.2.  See <tt>parsers/hsp</tt>.
<p>
<dt>Graph reduction:
<dd>Updates are in and we're doing graph reduction!  (All the bells and
whistles for doing a good job of [avoiding] updates are not
in yet.)
<p>
See <tt>compiler/codeGen/\{CodeGen,CgClosure\}.lhs</tt> and
<tt>runtime/main/Update.lhc</tt> for the main bits.
<p>
<dt>Closure layout less deeply wired into compiler:
<dd>Rather than knowing word-for-word how each closure is layed out in
memory, the compiler emits C macro calls to access/fill-in the "fixed
header" and "variable header" parts of each closure (all described
in the storage-manager document).
<p>
This means, for example, that the very same C code used on sequential
machines can be used on GRIP as well, even though closures in GRIP
have some extra fields -- all that is required is suitable <tt>.h</tt>
files to define the header macros accordingly!
<p>
Anyone whose efforts involve munging around in or pinning things onto
closures should like this "feature."
<p>
<dt>Statistics about program execution:
<dd>The compiler emits macro calls into the C output which, if expanded
(use <a href="#-DDO_RUNTIME_PROFILING"><tt>-DDO_RUNTIME_PROFILING</tt></a>, default: on), will accumulate
statistics about program behaviour.  To have those statistics printed
out (to <a href="#stderr"><tt>stderr</tt></a>), give your program the <a href="#-p"><tt>-p</tt></a> RTS flag, thusly:
<p>

<pre>
% a.out +RTS -p
</pre><p>

We welcome any interesting profiles that you may churn up!
<p>
See <tt>imports/StgProfile.h</tt> and <tt>runtime/main/StgProfile.lc</tt>,
plus insertions of those macro calls in
<tt>compiler/codeGen</tt>.
<p>
<dt>New simplifier/transformation stuff:
<dd>Contributed by research students Andre Santos and Andy Gill.  In
<tt>compiler/simplify</tt> and <tt>compiler/stranal-triv</tt>; it's still
thoroughly experimental.
<p>
The old-but-reliable brain-damaged simplifier is now in
<tt>compiler/simplify0</tt> and is still the default.
<p>
<dt>Compiler is compilable with Chalmers's HBC or Glasgow prototype compiler:
<dd>The default set of <tt>compiler/*/*.hi</tt> interface files in the
distribution are for compiling with HBC (this seems to be the people's
preference); version 0.997.3 or greater, please.
<p>
A separate set of <tt>.hi</tt> files are provided for those who use the
Glasgow prototype compiler.  These are in the file
<tt>ghc-0.06-proto-hi-files.tar.Z</tt>, available wherever you got the
basic distribution.  The installation document says how to deal with
these various blobs of files.
<p>
The possibility of using HBC means you can compile the Glasgow Haskell
compiler on any machine supported for HBC (Sun3s, Sun4s, DEC 3100s
[and one or two more flavours?]).
</dl>
<p>

<a name="0-06-new-in-compiler-contrib"><h3>In contributed bits of the compiler</h3></a>

<p>
<dl>
<p>
<dt>Semantique strictness analyser:
<dd>The one in the distribution now builds; in <tt>compiler/stranal-sem</tt>.
This would only be of interest to those who might want to play with
it.  The rest of the compiler can't use its results.
<p>
If you want to build this strictness analyser, you need to configure
appropriately (see <tt>mkworld/Project-ghc-full.*</tt>, when you get to
that part of the installation instructions).
</dl>
<p>
Please send us <i>your</i> bits for next time!
<p>

<a name="0-06-new-in-libraries"><h3>In <a href="#Prelude"><tt>Prelude</tt></a> and runtime support</h3></a>

<p>
<dl>
<p>
<dt>"Binary bloat" from the prelude, ameliorated:
<dd>The C files produced from compiling the prelude are chopped into
some 400 separate C files, which are individually compiled and 
banged into an archive.  Result is that you only get the bits you
"need," and binary sizes have about halved.
(There is more work to do in this department.)
<p>
<dt>Naive implementation of Haskell I/O:
<dd>At least <tt>ReadChan stdin</tt> and <tt>AppendChan stdout</tt> requests work.
It shouldn't be too hard to add support for other requests in
<tt>lib/io/DialogueToIO.lhs</tt>. (Only [extended] Haskell hacking needed!)
<p>
<dt>Storage management moved behind a safe wall:
<dd>It's now in <tt>runtime/storage/.</tt>  All four flavours of garbage
collector (two-space copying, one-space compacting, dual-mode, and
Appel-like generational) seem to work.
<p>
Patrick Sansom, research student and hacker extraordinaire, did all
of this.
<p>
<dt>Flags-to-RTS machinery in place:
<dd>When your <a href="#ghc"><tt>ghc</tt></a>-compiled Haskell program starts up, any command-line
arguments bracketted by <a href="#+RTS"><tt>+RTS</tt></a> and <a href="#-RTS"><tt>-RTS</tt></a> (or the end of the arguments)
are assumed to be flags for the runtime system.  These flags are used
to alter the heap size, ask for garbage-collection stats, etc.
<p>
To see what flags are available, try: <tt>myprog +RTS -f</tt>.
<p>
Patrick did this, too.
<p>
<dt>C-optimisation sleaziness also better hidden:
<dd>It is in <tt>runtime/c-as-asm/</tt>.  (It needs to be tidier, but...)
<p>
We are still actively working on getting this right.  Please get in
touch if you are interested.
</dl>
<p>

<a name="0-06-new-in-mkworld"><h3>In distribution/build/installation machinery</h3></a>

<p>
<dl>
<p>
<dt>Better line numbers, and Emacs-able TAGS files:
<dd>(Yes, they're related!) Error messages should come out with better
line numbers than before.
<p>
The distribution now includes tags-making things: souped-up <tt>etags</tt>
program [for C], <tt>perltags</tt> [for perl], and <tt>hstags</tt> [for
Haskell] (mostly in <tt>utils/scripts</tt>).  The Haskell tags program
uses the parser, so it Does It Right.
<p>
<tt>make tags fulltags</tt> at the top of the distribution tree will make a
huge TAGS file for the whole compilation system.
<p>
<dt><tt>make install</tt> might do something sensible:
<dd>Yes, it does.  But you'd be well advised to do a <tt>make -n install</tt>
just to check first!
</dl>
<p>

<a name="0-06-new-misc"><h3>Miscellaneous new things</h3></a>

<p>
<dl>
<p>
<dt>Consistency-checking for executables:
<dd>Given that our system can generate <tt>.o</tt> object files which are
seriously <i>incompatible</i> with each other, depending on choice of
garbage collector, degree of optimisation, whether or not compiling
for GRIP, etc., we have implemented a scheme (in the driver <tt>ghc</tt>)
that checks that all the linked bits in an executable "belong"
together.
<p>
<dt>Scripts from Denis Howe:
<dd>We have included his <tt>fptags</tt> and <tt>mira2hs</tt> scripts that he
posted to <tt>comp.lang.functional</tt>.
</dl>




<p>

<a name="release-0-05"><h2>Release notes for version 0.05 -- 12/91</h2></a>
<dl>
<p>
<dt>1.1 syntax:
<dd>Does <b>Haskell</b> version 1.1 syntax.  The code for the parser
(<tt>parsers/hsp/</tt>) has been tidied up quite a bit [nice job, Kevin].
<p>
<dt>Expressions and patterns:
<dd>All forms of expressions and patterns work, including overloaded
patterns and <a href="#n+k"><tt>n+k</tt></a> patterns.
<p>
<dt>A big part of the standard prelude is operational:
<dd>These parts (in <tt>lib/prelude</tt>) have been compiled with the new
compiler, and programs compiled with the new compiler can be linked to
it.
<p>
With the exceptions of (a) hooking in the standard Haskell I/O system
(see next item) and (b) special pleading for constant-time-access
arrays (or other magical features), all Prelude stuff is either done
or easily do-able.
<p>
<dt>Simple resolution of ambiguous overloading of numeric types:
<dd>(As per Haskell report, section 4.3.4).  <a href="#default"><tt>default</tt></a> declarations do
<i>NOT</i> work; however, the "default default"
(<a href="#default (Int, Double)"><tt>default (Int, Double)</tt></a>) is wired in.  This should clear up nearly
all annoying "ambiguous dictionary" errors.
<p>
<dt>Better non-standard I/O:
<dd>We have implemented the bare bones of the I/O described in
<tt>docs/io-design/</tt>.  It's not standard <b>Haskell</b> I/O
(we haven't yet implemented the impedance-matcher discussed in the
doc), and it's not the same as what was there in 0.02.  However, you
can now write a simple reads-stdin/writes-stdout program:
<p>

<pre>
#include "GhcPrelude.h"

main = readString `thenIO` ( \ s -&gt;
       writeString (my_String_to_String_manglification s) )
</pre><p>

The implementation of <a href="#error"><tt>error</tt></a> (via <a href="#sysError"><tt>sysError</tt></a>) is also as described in
the I/O document.
<p>
<dt>Faster compiler:
<dd>The compiler is faster than version 0.02 -- we promise -- but the
significant tuning work is not yet done.  We will do it after The
Mangler (renamer) is in.
<p>
<dt>Run compiled code on a Sun4:
<dd>If you compile your program to C (<tt>.hc</tt> files), with, e.g.:
<p>

<pre>
% glhc -C Foo.hs
</pre><p>

then you compile the output on a Sun4 with:
<p>

<pre>
% glhc -c Foo.hc
</pre><p>

and, if you have the right things to link to, you can link with:
<p>

<pre>
% glhc -o foo Foo.o
</pre><p>

The "right things to link to" include: the runtime system (
<tt>cd runtimes/standard; make</tt> on a sun4), and the standard libraries
(<tt>cd lib; make all</tt> on a sun4).
<p>
We have not yet tried to make this work for Every Known Unix Box In
The Universe.  (But we plan to, with your help :-)
<p>
<dt>Upheaval during FPCA:
<dd>As advertised with 0.02: Files moved around, modules and data types
were renamed, and a generally Much Cleaner World now exists.  We have
no plans to do more of the same (at least for the compiler proper).
</dl>




<p>

<a name="releases-0-03-04"><h2>Releases between 0.02 and 0.05</h2></a>

There were a couple of private releases to highly zealous people,
mainly our friends at York.  There are README files in the
<tt>release_notes/</tt> dir about those, if you are really interested.
<p>

<a name="release-0-02"><h2>Release notes for version 0.02 -- 8/91</h2></a>
Nothing about version 0.02, our very first release, is still
interesting :-)
<p>
<p>

<address>Generated by Will Partain (for the AQUA Team)  Department of Computing Science  University of Glasgow  Glasgow, Scotland  G12 8QQ    Email: glasgow-haskell-{users,bugs}-request@dcs.glasgow.ac.uk  using <tt>lit2html</tt></address></body></html>
